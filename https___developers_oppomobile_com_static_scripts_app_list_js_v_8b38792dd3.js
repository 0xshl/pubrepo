!function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n;return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r}()({1:[function(require,module,exports){!function(root,factory){if('function'===typeof define&&define.amd)define([],factory);else if('object'===typeof exports)module.exports=factory();else root.Util=factory()}(this,function(){var htmlTags_font=['id','class','color','size','face','.background-color'],htmlTags_span=['id','class','.color','.background-color','.font-size','.font-family','.background','.font-weight','.font-style','.text-decoration','.vertical-align','.line-height'],htmlTags_div=['id','class','align','.border','.margin','.padding','.text-align','.color','.background-color','.font-size','.font-family','.font-weight','.background','.font-style','.text-decoration','.vertical-align','.margin-left'],htmlTags_table=['id','class','border','cellspacing','cellpadding','width','height','align','bordercolor','.padding','.margin','.border','bgcolor','.text-align','.color','.background-color','.font-size','.font-family','.font-weight','.font-style','.text-decoration','.background','.width','.height','.border-collapse'],htmlTags_td_th=['id','class','align','valign','width','height','colspan','rowspan','bgcolor','.text-align','.color','.background-color','.font-size','.font-family','.font-weight','.font-style','.text-decoration','.vertical-align','.background','.border'],htmlTags_a=['id','class','href','target','name'],htmlTags_embed=['id','class','src','width','height','type','loop','autostart','quality','.width','.height','align','allowscriptaccess','wmode'],htmlTags_img=['id','class','src','width','height','border','alt','title','align','.width','.height','.border','onerror','click'],htmlTags_p_ol_ul_li_blockquote_h1_h2_h3_h4_h5_h6=['id','class','align','.text-align','.color','.background-color','.font-size','.font-family','.background','.font-weight','.font-style','.text-decoration','.vertical-align','.text-indent','.margin-left'],htmlTags_pre=['id','class'],htmlTags_hr=['id','class','.page-break-after'],htmlTags_br_tbody_tr_strong_b_sub_sup_em_i_u_strike_s_del=['id','class'],htmlTags_iframe=['id','class','src','frameborder','width','height','.width','.height'],_each=function(obj,fn){if($.isArray(obj)){for(var i=0,len=obj.length;i<len;i++)if(!1===fn.call(obj[i],i,obj[i]))break}else for(var key in obj)if(obj.hasOwnProperty(key))if(!1===fn.call(obj[key],key,obj[key]))break},_toMap=function(val,delimiter){delimiter=void 0===delimiter?',':delimiter;var map={},arr=$.isArray(val)?val:val.split(delimiter),match;_each(arr,function(key,val){if(match=/^(\d+)\.\.(\d+)$/.exec(val))for(var i=parseInt(match[1],10);i<=parseInt(match[2],10);i++)map[i.toString()]=!0;else map[val]=!0});return map},_getAttrList=function(tag){var list={},reg=/\s+(?:([\w\-:]+)|(?:([\w\-:]+)=([^\s"'<>]+))|(?:([\w\-:"]+)="([^"]*)")|(?:([\w\-:"]+)='([^']*)'))(?=(?:\s|\/|>)+)/g,match;while(match=reg.exec(tag)){var key=(match[1]||match[2]||match[4]||match[6]).toLowerCase(),val=(match[2]?match[3]:match[4]?match[5]:match[7])||'';list[key]=val}return list},_undef=function(val,defaultVal){return void 0===val?defaultVal:val},_INLINE_TAG_MAP=_toMap('a,abbr,acronym,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,img,input,ins,kbd,label,map,q,s,samp,select,small,span,strike,strong,sub,sup,textarea,tt,u,var'),_BLOCK_TAG_MAP=_toMap('address,applet,blockquote,body,center,dd,dir,div,dl,dt,fieldset,form,frameset,h1,h2,h3,h4,h5,h6,head,hr,html,iframe,ins,isindex,li,map,menu,meta,noframes,noscript,object,ol,p,pre,script,style,table,tbody,td,tfoot,th,thead,title,tr,ul'),_SINGLE_TAG_MAP=_toMap('area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed'),_STYLE_TAG_MAP=_toMap('b,basefont,big,del,em,font,i,s,small,span,strike,strong,sub,sup,u'),_CONTROL_TAG_MAP=_toMap('img,table,input,textarea,button'),_PRE_TAG_MAP=_toMap('pre,style,script'),_NOSPLIT_TAG_MAP=_toMap('html,head,body,td,tr,table,ol,ul,li'),_AUTOCLOSE_TAG_MAP=_toMap('colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr'),_FILL_ATTR_MAP=_toMap('checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected'),_VALUE_TAG_MAP=_toMap('input,button,textarea,select'),_formatUrl=function(url,mode,host,pathname){mode=_undef(mode,'').toLowerCase();if('data:'!=url.substr(0,5))url=url.replace(/([^:])\/\//g,'$1/');if($.isArray(mode,['absolute','relative','domain'])<0)return url;host=host||location.protocol+'//'+location.host;if(void 0===pathname){var m=location.pathname.match(/^(\/.*)\//);pathname=m?m[1]:''}var match;if(match=/^(\w+:\/\/[^\/]*)/.exec(url)){if(match[1]!==host)return url}else if(/^\w+:/.test(url))return url;function getRealPath(path){for(var parts=path.split('/'),paths=[],i=0,len=parts.length;i<len;i++){var part=parts[i];if('..'==part){if(paths.length>0)paths.pop()}else if(''!==part&&'.'!=part)paths.push(part)}return'/'+paths.join('/')}if(/^\//.test(url))url=host+getRealPath(url.substr(1));else if(!/^\w+:\/\//.test(url))url=host+getRealPath(pathname+'/'+url);function getRelativePath(path,depth){if(url.substr(0,path.length)===path){for(var arr=[],i=0;i<depth;i++)arr.push('..');var prefix='.';if(arr.length>0)prefix+='/'+arr.join('/');if('/'==pathname)prefix+='/';return prefix+url.substr(path.length)}else if(match=/^(.*)\//.exec(path))return getRelativePath(match[1],++depth)}if('relative'===mode)url=getRelativePath(host+pathname,0).substr(2);else if('absolute'===mode)if(url.substr(0,host.length)===host)url=url.substr(host.length);return url},_toHex=function(val){function hex(d){var s=parseInt(d,10).toString(16).toUpperCase();return s.length>1?s:'0'+s}return val.replace(/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/gi,function($0,$1,$2,$3){return'#'+hex($1)+hex($2)+hex($3)})},_getCssList=function(css){var list={},reg=/\s*([\w-]+)\s*:([^;]*)(;|$)/g,match;while(match=reg.exec(css)){var key=$.trim(match[1].toLowerCase()),val=$.trim(_toHex(match[2]));list[key]=val}return list},_formatHtml=function(html,htmlTags,urlType,wellFormatted,indentChar){if(null==html)html='';urlType=urlType||'';wellFormatted=_undef(wellFormatted,!1);indentChar=_undef(indentChar,'\t');var fontSizeList='xx-small,x-small,small,medium,large,x-large,xx-large'.split(',');html=(html=(html=(html=(html=(html=(html=(html=(html=html.replace(/(<(?:pre|pre\s[^>]*)>)([\s\S]*?)(<\/pre>)/gi,function($0,$1,$2,$3){return $1+$2.replace(/<(?:br|br\s[^>]*)>/gi,'\n')+$3})).replace(/<(?:br|br\s[^>]*)\s*\/?>\s*<\/p>/gi,'</p>')).replace(/(<(?:p|p\s[^>]*)>)\s*(<\/p>)/gi,'$1<br />$2')).replace(/\u200B/g,'')).replace(/\u00A9/g,'&copy;')).replace(/\u00AE/g,'&reg;')).replace(/\u2003/g,'&emsp;')).replace(/\u3000/g,'&emsp;')).replace(/<[^>]+/g,function($0){return $0.replace(/\s+/g,' ')});var htmlTagMap={};if(htmlTags){_each(htmlTags,function(key,val){for(var arr=key.split(','),i=0,len=arr.length;i<len;i++)htmlTagMap[arr[i]]=_toMap(val)});if(!htmlTagMap.script)html=html.replace(/(<(?:script|script\s[^>]*)>)([\s\S]*?)(<\/script>)/gi,'');if(!htmlTagMap.style)html=html.replace(/(<(?:style|style\s[^>]*)>)([\s\S]*?)(<\/style>)/gi,'')}var re=/(\s*)<(\/)?([\w\-:]+)((?:\s+|(?:\s+[\w\-:]+)|(?:\s+[\w\-:]+=[^\s"'<>]+)|(?:\s+[\w\-:"]+="[^"]*")|(?:\s+[\w\-:"]+='[^']*'))*)(\/)?>(\s*)/g,tagStack=[];html=(html=(html=(html=html.replace(re,function($0,$1,$2,$3,$4,$5,$6){var full=$0,startNewline=$1||'',startSlash=$2||'',tagName=$3.toLowerCase(),attr=$4||'',endSlash=$5?' '+$5:'',endNewline=$6||'';if(htmlTags&&!htmlTagMap[tagName])return'';if(''===endSlash&&_SINGLE_TAG_MAP[tagName])endSlash=' /';if(_INLINE_TAG_MAP[tagName]){if(startNewline)startNewline=' ';if(endNewline)endNewline=' '}if(_PRE_TAG_MAP[tagName])if(startSlash)endNewline='\n';else startNewline='\n';if(wellFormatted&&'br'==tagName)endNewline='\n';if(_BLOCK_TAG_MAP[tagName]&&!_PRE_TAG_MAP[tagName])if(wellFormatted){if(startSlash&&tagStack.length>0&&tagStack[tagStack.length-1]===tagName)tagStack.pop();else tagStack.push(tagName);startNewline='\n';endNewline='\n';for(var i=0,len=startSlash?tagStack.length:tagStack.length-1;i<len;i++){startNewline+=indentChar;if(!startSlash)endNewline+=indentChar}if(endSlash)tagStack.pop();else if(!startSlash)endNewline+=indentChar}else startNewline=endNewline='';if(''!==attr){var attrMap=_getAttrList(full);if('font'===tagName){var fontStyleMap={},fontStyle='';_each(attrMap,function(key,val){if('color'===key){fontStyleMap.color=val;delete attrMap[key]}if('size'===key){fontStyleMap['font-size']=fontSizeList[parseInt(val,10)-1]||'';delete attrMap[key]}if('face'===key){fontStyleMap['font-family']=val;delete attrMap[key]}if('style'===key)fontStyle=val});if(fontStyle&&!/;$/.test(fontStyle))fontStyle+=';';_each(fontStyleMap,function(key,val){if(''===val)return;if(/\s/.test(val))val="'"+val+"'";fontStyle+=key+':'+val+';'});attrMap.style=fontStyle}_each(attrMap,function(key,val){if(_FILL_ATTR_MAP[key])attrMap[key]=key;if(htmlTags&&'style'!==key&&!htmlTagMap[tagName]['*']&&!htmlTagMap[tagName][key]||'body'===tagName&&'contenteditable'===key||/^kindeditor_\d+$/.test(key))delete attrMap[key];if('style'===key&&''!==val){var styleMap=_getCssList(val);_each(styleMap,function(k,v){if(htmlTags&&!htmlTagMap[tagName].style&&!htmlTagMap[tagName]['.'+k])delete styleMap[k]});var style='';_each(styleMap,function(k,v){style+=k+':'+v+';'});attrMap.style=style}});attr='';_each(attrMap,function(key,val){if('style'===key&&''===val)return;val=val.replace(/"/g,'&quot;');attr+=' '+key+'="'+val+'"'})}if('font'===tagName)tagName='span';return startNewline+'<'+startSlash+tagName+attr+endSlash+'>'+endNewline})).replace(/(<(?:pre|pre\s[^>]*)>)([\s\S]*?)(<\/pre>)/gi,function($0,$1,$2,$3){return $1+$2.replace(/\n/g,'<span id="__kindeditor_pre_newline__">\n')+$3})).replace(/\n\s*\n/g,'\n')).replace(/<span id="__kindeditor_pre_newline__">\n/g,'\n');return $.trim(html)},frag=null,Util={dataBinder:function(object_id){var $pubSub=$({}),data_attr='bind-'+object_id,message=object_id+':change';$(document).on('change','[data-'+data_attr+']',function(evt){var $input=$(this);$pubSub.trigger(message,[$input.data(data_attr),$input.val()])});$pubSub.on(message,function(evt,prop_name,new_val){$('[data-'+data_attr+'='+prop_name+']').each(function(){var $bound=$(this);if($bound.is('input, text area, select'))$bound.val(new_val);else $bound.html(new_val)})});return $pubSub},clearMsWord:function(html,htmlTags){html=html.replace(/<meta[\s\S]*?>/gi,'').replace(/'/gi,'\'').replace(/<![\s\S]*?>/gi,'').replace(/<style[^>]*>[\s\S]*?<\/style>/gi,'').replace(/<script[^>]*>[\s\S]*?<\/script>/gi,'').replace(/<w:[^>]+>[\s\S]*?<\/w:[^>]+>/gi,'').replace(/<o:[^>]+>[\s\S]*?<\/o:[^>]+>/gi,'').replace(/<xml>[\s\S]*?<\/xml>/gi,'').replace(/<p[^>]*>/gi,'<p>').replace(/<span[^>]*>/gi,'<span>').replace(/<\/?spanyes[^>]*>/gi,'').replace(/<\/?fieldset[^>]*>/gi,'').replace(/<legend>/gi,'<p>').replace(/<\/legend>/gi,'</p>').replace(/<\/?form[^>]*>/gi,'').replace(/<\/?input[^>]*>/gi,'').replace(/<\/?textarea[^>]*>/gi,'').replace(/<(\w[^>]*) style="([^"]*)"([^>]*)/gi,'<$1$3').replace(/<(?:table|td)[^>]*>/gi,function(full){return full.replace(/border-bottom:([#\w\s]+)/gi,'border:$1')});return _formatHtml(html,htmlTags)},flatConten:function(content,needSpace,needSpaceline){if(!content)return'';if(null===frag)frag=document.createElement('div');if(needSpace)frag.innerHTML=content.replace(/<style>[\s\S]*<\/style>/g,'').replace(/<w:[\s\S]*>[\s\S]*<\/w:[a-zA-Z]+>/g,'').replace(/&nbsp;/g,' ').replace(/<[^>]*>/g,'').replace(/[\r\n]/g,'');else if(needSpaceline)frag.innerHTML=content.replace(/<style>[\s\S]*<\/style>/g,'').replace(/<w:[\s\S]*>[\s\S]*<\/w:[a-zA-Z]+>/g,'').replace(/&nbsp;/g,' ').replace(/<[^>]*>/g,'');else frag.innerHTML=content.replace(/<style>[\s\S]*<\/style>/g,'').replace(/<w:[\s\S]*>[\s\S]*<\/w:[a-zA-Z]+>/g,'').replace(/&nbsp;/g,' ').replace(/<[^>]*>/g,'').replace(/\s/g,'').replace(/[\r\n]/g,'');return content=frag.textContent||frag.innerText||''},calContentSize:function(id,needSpace,needSpaceline){var $text=$('textarea[data-id="'+id+'"]'),content=this.flatConten($text.val(),needSpace,needSpaceline),length=$text.attr('maxlength'),len=length;if(content.length>=length)len=0;else len=length-content.length;$('.indicate-number[data-id="'+id+'"]').html(content.length)},trimContent:function(html){var txt=Util.clearMsWord(html);if('<p><br /></p>'==txt||'<p><br/></p>'==txt||'<p><br></p>'==txt)txt='';return txt},Cache:{set:function(key,value){if(window.localStorage)try{if(null!==this.get(key))this.remove(key);localStorage.setItem(key,value)}catch(e){if('QUOTA_EXCEEDED_ERR'===e.name||'NS_ERROR_DOM_QUOTA_REACHED'===e.name);}},get:function(key){if(window.localStorage){var v=localStorage.getItem(key);return void 0===v?null:v}},remove:function(key){window.localStorage&&localStorage.removeItem(key)},clear:function(){window.localStorage&&localStorage.clear()}},setUrlPara:function(url,key,val){var re=new RegExp('([?&])'+key+'=.*?(&|$)','i'),separator=-1!==url.indexOf('?')?'&':'?';if(url.match(re))return url.replace(re,'$1'+key+'='+val+'$2');else return url+separator+key+'='+val},clearHtmlTag:function(t){return t.replace(/<[^>]+>/g,'')}};return Util})},{}],2:[function(require,module,exports){!function(root,factory){if('function'===typeof define&&define.amd)define([],factory);else if('object'===typeof exports)module.exports=factory();else root.AppItem=factory()}(this,function(){var AppItem=function(container,data,config,callbacks){this.$container=container instanceof $?container:$(container);this.data={};if(data)this.data=$.extend(!0,this.data,data);this.config={};if(config)this.config=$.extend(!0,this.config,config);this.callbacks={};if(callbacks)this.callbacks=$.extend(!0,this.callbacks,callbacks);this.obj={};if(this.data)this.Init()},getNotice=function(data){if(8!=parseInt(data.type,10)){var txt='';if(1==parseInt(data.level,10)&&0!==data.manual_test_state)txt+='Hidden in category';else if(0==parseInt(data.level,10))txt+='Hidden in category, Hidden in search';else if(2==parseInt(data.level,10)&&0!==data.manual_test_state)txt='';return filterXSS(txt)}return''},formatName=function(obj){if('recieve'==obj.ctrl)return obj.app_name||'---';var html='<span class="appname">'+filterXSS(obj.app_name||'---');if(obj.app_subname)html+='<i>('+filterXSS(obj.app_subname)+')</i>';return html+='</span>'},formatVersion=function(obj){if('recieve'==obj.ctrl)return obj.version_name||'---';var html='<span class="version">'+filterXSS(obj.version_name||'---')+'</span>';if(obj.channel>1)html+='<p>(Update from the cooperation channel)</p>';return html},formatStatus=function(obj){if('recieve'==obj.ctrl)return'---';var html;return'<a href="javascript:void(0)" class="to-details">View details</a>'},formatPkgNum=function(obj){var html;return'<span class="version">'+filterXSS(obj.pkg_num||'---')+'</span>'};function removeChineseDate(d){return d.replace('年','-').replace('月','-').replace('日','')}AppItem.prototype={Init:function(){var self=this,tgt=null;if('undefined'==typeof this.data.icon_url)this.data.icon_url='/static/images/app_default_icon.png';var HTML='<tr class="">'+'<td class="icon">'+'<img class="lazy" src="'+this.data.icon_url+'" width="50" height="50">'+formatName(this.data)+'</td>'+'<td>'+formatPkgNum(this.data)+'</td>'+'<td>'+formatVersion(this.data)+'</td>'+'<td>'+filterXSS(removeChineseDate(this.data.update_time)||'---')+'</td>'+'<td>'+this._getButton(this.data.ctrl,this.data)+'</td>'+'</tr>';this.obj.$el=$(HTML).appendTo(this.$container);this.obj.icon_url=this.obj.$el.find('.icon');this.obj.app_name=this.obj.$el.find('.appname');this.obj.status_txt=this.obj.$el.find('.status');this.obj.version_name=this.obj.$el.find('.version');this.obj.update_time=this.obj.$el.find('.time');this.obj.btn_txt=this.obj.$el.find('button');this.obj.btn_wrap=this.obj.$el.find('.ctrl');this.obj.$el.bind('click',function(e){tgt=e.target;if('function'===typeof self.callbacks.onClick)if('button'===tgt.tagName.toLowerCase()){if($(tgt).hasClass('update'))self.callbacks.onClick(self.data,'btn','update');else if($(tgt).hasClass('info'))self.callbacks.onClick(self.data,'btn','info');else if($(tgt).hasClass('business-update'))self.callbacks.onClick(self.data,'btn','business-update');else if($(tgt).hasClass('receive'))self.callbacks.onClick(self.data,'btn','receive');else if($(tgt).hasClass('publish'))self.callbacks.onClick(self.data,'btn','publish');else if($(tgt).hasClass('associated'))self.callbacks.onClick(self.data,'btn','associated');else if($(tgt).hasClass('material'))self.callbacks.onClick(self.data,'btn','material');else if($(tgt).hasClass('to-details'))self.callbacks.onClick(self.data,'view');else if($(tgt).hasClass('to-publish'))self.callbacks.onClick(self.data,'btn','publish');else if($(tgt).hasClass('to-delete'))self.callbacks.onClick(self.data,'btn','deleteBase')}else if($(tgt).closest('td').hasClass('icon'))self.callbacks.onClick(self.data,'view')})},_clear:function(){this.obj.$el.unbind('click');this.obj.$el.remove();for(var o in this.obj)if('Clear'!==o){this.obj[o]=null;delete this.obj[o]}},_getButton:function(ctrl,data){if(1==data.is_business)return'<button type="button" class="btn btn-primary to-details">View details</button>';else if(data.hasOwnProperty('is_published')&&!data.is_published)if(data.is_remove_able)return'<button type="button" class="btn btn-primary to-publish">Publish</button>'+'<button type="button" class="btn btn-primary to-delete">Delete</button>';else return'<button type="button" class="btn btn-primary to-publish">Publish</button>';else return'<button type="button" class="btn btn-primary to-details">View details</button>'},UpdateData:function(data){this.data=$.extend(!0,this.data,data);for(var o in data)if(this.obj[o])if('icon_url'===o)this.obj[o].attr({src:data[o]});else this.obj[o].text(data[o]);this.obj.btn_wrap.html(this._getButton(data.ctrl))},Clear:function(){this._clear()}};return AppItem})},{}],3:[function(require,module,exports){!function(root,factory){if('function'===typeof define&&define.amd)define([],factory);else if('object'===typeof exports)module.exports=factory();else root.List=factory()}(this,function(){var List=function(container,data,config,callbacks){this.$container=container instanceof $?container:$(container);this.data=[];if(data)this.data=$.extend(!0,this.data,data);this.config={type:'list',tableHeader:[],item:config.item||window.Item};if(config)this.config=$.extend(!0,this.config,config);this.callbacks={};if(callbacks)this.callbacks=$.extend(!0,this.callbacks,callbacks);this.loading=!1;this.Init()};List.prototype={Init:function(){var self=this;this.HTML='table'==this.config.type?'<table class="'+(this.config.table_class||'table')+'"><colgroup>'+this._initTableCol()+'</colgroup><thead><tr>'+this._initTableHeader()+'</tr></thead><tbody><tr class="loading"><td colspan="'+this.config.tableHeader.length+'">loading</td></tr></tbody></table>':'<ul class="list-group"><li class="no-data loading">loading</li></ul>';this.$el=$(this.HTML).appendTo(this.$container);this.$itemWrap='table'==this.config.type?this.$el.find('tbody'):this.$el;this.$loading=this.$el.find('.loading');this.listObj=[];if(this.data.length>0)this._bindData(this.data)},_initTableCol:function(){var str='';if(this.config.tableHeader.length>0)for(var k=this.config.tableHeader.length,i=0;i<k;i++)str=str+'<col width="'+(this.config.tableHeader[i]['width']||'')+'">';return str},_initTableHeader:function(){var str='';if(this.config.tableHeader.length>0)for(var k=this.config.tableHeader.length,i=0;i<k;i++)str=str+'<th>'+(this.config.tableHeader[i]['txt']||'')+'</th>';return str},_bindData:function(data){if(1==this.loading)return!1;if(data.length>0){for(var k=Math.min(this.config.size,data.length),i=0;i<k;i++)if(this.listObj[i])this.listObj[i].UpdateData(data[i]);else if(this.config.item)this.listObj[i]=new this.config.item(this.$itemWrap,data[i],this.config,this.callbacks)}else this.$itemWrap.html('table'==this.config.type?'<tr><td colspan="'+this.config.tableHeader.length+'" style="text-align:center">empty</td></tr>':'<li class="no-data">empty</li>')},_clear:function(callback){for(var o in this.listObj){this.listObj[o].Clear();delete this.listObj[o]}this.listObj=[];this.$itemWrap.empty();if('function'==typeof callback)callback()},UpdateData:function(data,needUpdate){this.loading=!1;this.$loading.hide();if(data){var needClear=this.data.length!==data.length||needUpdate;this.data=data;this._clear();this._bindData(this.data)}},SetContent:function(str){this.loading=!0;this.$loading.show()}};return List})},{}],4:[function(require,module,exports){var Util=require('../../../common/scripts/util'),Pagination=require('../../../vendor/scripts/jquery.simplePagination'),Item=require('../../../components/app_item/scripts/app_item'),List=require('../../../components/list/scripts/list');!function(root,factory){if('function'===typeof define&&define.amd)define([],factory);else if('object'===typeof exports)module.exports=factory();else root.returnExports=factory()}(this,function(){var getQueryString=function(name){var queryStr,paramsStr=(window.location.search||window.location.hash).substring(1);if(paramsStr=paramsStr.replace(/\?/g,'&')){var reg=new RegExp('(^|&)'+name+'=([^&]*)(&|$)','i'),r=paramsStr.match(reg);if(null!==r)return decodeURI(r[2]);return null}return null},tabStatus={curType:'all',curPage:1};tabStatus.curType=getQueryString('type')||'app';$('#'+tabStatus.curType).addClass('active');var url='/resource/list/index.json',itemsOnPage=20,typeMapping={all:0,app:7,game:9,pay:8},listObj={all:{curPage:1,obj:null,pager:null,needUpdate:!0},app:{curPage:1,obj:null,pager:null,needUpdate:!0},game:{curPage:1,obj:null,pager:null,needUpdate:!0},pay:{curPage:1,obj:null,pager:null,needUpdate:!0},recieve:{curPage:1,obj:null,pager:null,needUpdate:!0}},curType=tabStatus['curType'],app_name='',state='',loading=!1,Eval=function(data){if('object'===typeof data)return data;else if('string'===typeof data){var Fn;return new Function('return '+data)()}},$keywordEl=$('.keyword'),$recordsEl=$('.records'),getLabelTxt=function(status){var mapping;return{0:'Drafts',1:'In Review',2:'Passed',3:'Test failed',4:'Operation review',5:'Operation Rejected',6:'Operation Approved',7:'Scheduled release','00':'In business review',11:'Operation review passed','-11':'Operation review rejected',22:'Frozen',111:'Released',222:'Removed',444:'Rejected'}[status]||''},getBtnState=function(type,status,is_business){var obj={type:'view'};if(1==status||'00'==status||'4'==status||1==status&&'1'==is_business)obj['type']='view';if('444'==status||'222'==status||'3'==status&&'1'==is_business||'5'==status||'7'==status)obj['type']='update';if('11'==status)obj['type']='publish';if('111'==status)obj['type']='online';if('-11'==status)obj['type']='business-fail';return obj},getData=function(callback){if(1==loading)return!1;loading=!0;var xx={};$.ajax({type:"POST",url:url,data:{type:typeMapping[curType],limit:itemsOnPage,offset:(listObj[curType]['curPage']-1)*itemsOnPage,app_name:app_name,state:state},success:function(res){loading=!1;if(0===Eval(res)['errno']){var D='recieve'==curType?{errno:0,data:{rows:Eval(res)['data']['wait_receive_games'],total:Eval(res)['data']['wait_receive_games'].length}}:Eval(res);if(0===D.errno){var data=D['data'];for(var o in data['rows'])data['rows'][o]['ctrl']='recieve'==curType?'recieve':xx['type'];if('function'===typeof callback)callback(data)}}else if('function'===typeof callback)callback({rows:[]})}})},eventMap={},ename='admin-redirect',createAppList=function(type,page){if(null===listObj[type]['obj'])listObj[type]['obj']=new List($('#'+type+' .content'),[],{tableHeader:[{width:'30%'},{width:'20%'},{width:'20%'},{width:'20%'},{width:'10%'}],size:itemsOnPage,table_class:'app-list-v2',type:'table',item:Item},{onClick:function(data,ctrl,type){if('undefined'===typeof eventMap[ename])eventMap[ename]=$.Event(ename);if('freeze'===ctrl)if(8==data['type'])window.admin_url='/resource/games/detail?app_id='+data['app_id'];else window.admin_url='/resource/detail?app_id='+data['app_id'];else if('refuse'===ctrl)window.admin_url='/resource/detail?app_id='+data['app_id'];else if('reason'===ctrl)if(8==data['type'])window.admin_url='/resource/version/list?app_id='+data['app_id']+'&type=2';else window.admin_url='/resource/version/list?app_id='+data['app_id']+'&type=1';else if('view'===ctrl)if('recieve'===data['ctrl'])window.admin_url='/resource/games/receive?app_id='+data['app_id']+'&dev_id='+data.dev_id;else if(8==data['type']&&1==data['is_business'])if(''!=data['version_name'])window.admin_url='/resource/games/detail?app_id='+data['app_id']+'&version_name='+data['version_name'];else window.admin_url='/resource/games/detail?app_id='+data['app_id'];else if(''!=data['version_name'])window.admin_url='/resource/detail?app_id='+data['app_id']+'&version_name='+data['version_name'];else window.admin_url='/resource/detail?app_id='+data['app_id'];else if('btn'===ctrl){if('recieve'===data['ctrl'])window.admin_url='/resource/games/receive?app_id='+data['app_id']+'&dev_id='+data.dev_id;if('associated'===type&&8==data['type']&&1==data['apply_associate_status'])window.admin_url='/resource/games/update?app_id='+data['app_id'];if('material'===type&&8==data['type']&&1==data['apply_associate_status'])window.admin_url='/resource/games/update-info?app_id='+data['app_id'];if('publish'===type)if(8==data.type&&1==data.is_business)window.admin_url='/resource/games/publish?app_id='+data['app_id'];else if(7==data.type)window.admin_url='/resource/publish?type=7&app_id='+data['app_id'];else window.admin_url='/resource/publish?type=9&app_id='+data['app_id'];if('deleteBase'===type)deleteBase(data['app_id'],data['pkg_name']).then(res=>{if(0==res.errno)window.location.reload()})}$('body').trigger(eventMap[ename])}});if(!0===listObj[type]['needUpdate']){listObj[type]['obj'].SetContent('<li class="no-data">loading……</li>');getData(function(data){listObj[type]['obj'].UpdateData(data['rows']);if(null===listObj[type]['pager']&&data.total>itemsOnPage)listObj[type]['pager']=$('#'+type+' .pagination-wrap').pagination({items:data.total,itemsOnPage:itemsOnPage,hrefTextPrefix:'#/resource/list?type='+tabStatus.curType+'|',currentPage:listObj[curType]['curPage'],onPageClick:function(n,e){listObj[type]['needUpdate']=!0;listObj[curType]['curPage']=n;tabStatus['curPage']=n;createAppList(curType,n)}});else tabStatus['curPage']=1;if(data['rows'].length<itemsOnPage)tabStatus['curPage']=1;if(listObj[type]['pager'])listObj[type]['pager'].pagination('updateItems',data.total);listObj[type]['needUpdate']=!1;$recordsEl.text(data.total)})}Util.Cache.set('app-list',JSON.stringify(tabStatus))};listObj[tabStatus['curType']]['curPage']=tabStatus['curPage'];if('recieve'==tabStatus['curType'])url='/resource/games/receivelist.json';else url='/resource/list/index.json';createAppList(curType,1);$('button.search').click(function(e){e.preventDefault();app_name=$('input.search').val();for(var o in listObj)listObj[o]['needUpdate']=!0;createAppList(curType,1)});$('input.search').keyup(function(e){e.preventDefault();if(13==e.keyCode){app_name=$('input.search').val();for(var o in listObj)listObj[o]['needUpdate']=!0;createAppList(curType,1)}});$('.filter select').change(function(e){listObj[tabStatus['curType']]['curPage']=1;state=$(this).val();listObj[this.name]['needUpdate']=!0;createAppList(curType,1)});$('a.app').click(function(e){e.preventDefault();window.admin_url='/resource/publish';if('undefined'===typeof eventMap[ename])eventMap[ename]=$.Event(ename);$('body').trigger(eventMap[ename])});$('.add-btn').on('click',function(){switch(curType){case'app':window.admin_url='/resource/publish/firstpublish?type=7';break;case'game':window.admin_url='/resource/games?type=9';break;case'pay':window.admin_url='/resource/games?type=8';break}if('undefined'===typeof eventMap[ename])eventMap[ename]=$.Event(ename);$('body').trigger(eventMap[ename])});var deleteBase=function(app_id,pkg_name){return $.ajax({type:'POST',url:'/resource/publish/deletefirstpublish',data:{app_id:app_id,pkg_name:pkg_name},success(res){if(0==res.errno){console.log(res.data);createAppList(curType)}}})};if('recieve'==curType){listObj[curType]['needUpdate']=!0;url='/resource/games/receivelist.json'}else url='/resource/list/index.json';if(listObj[curType]['needUpdate'])createAppList(curType,1);else createAppList(curType)})},{"../../../common/scripts/util":1,"../../../components/app_item/scripts/app_item":2,"../../../components/list/scripts/list":3,"../../../vendor/scripts/jquery.simplePagination":5}],5:[function(require,module,exports){$=jQuery,methods={init:function(options){var o=$.extend({items:1,itemsOnPage:1,pages:0,displayedPages:5,edges:2,currentPage:0,useAnchors:!0,hrefTextPrefix:'#page-',hrefTextSuffix:'',prevText:'Prev',nextText:'Next',ellipseText:'&hellip;',ellipsePageSet:!0,cssStyle:'light-theme',listStyle:'',labelMap:[],selectOnClick:!0,nextAtFront:!1,invertPageOrder:!1,useStartEdge:!0,useEndEdge:!0,onPageClick:function(pageNumber,event){},onInit:function(){}},options||{}),self=this;o.pages=o.pages?o.pages:Math.ceil(o.items/o.itemsOnPage)?Math.ceil(o.items/o.itemsOnPage):1;if(o.currentPage)o.currentPage=o.currentPage-1;else o.currentPage=!o.invertPageOrder?0:o.pages-1;o.halfDisplayed=o.displayedPages/2;this.each(function(){self.addClass(o.cssStyle+' simple-pagination').data('pagination',o);methods._draw.call(self)});o.onInit();return this},selectPage:function(page){methods._selectPage.call(this,page-1);return this},prevPage:function(){var o=this.data('pagination');if(!o.invertPageOrder){if(o.currentPage>0)methods._selectPage.call(this,o.currentPage-1)}else if(o.currentPage<o.pages-1)methods._selectPage.call(this,o.currentPage+1);return this},nextPage:function(){var o=this.data('pagination');if(!o.invertPageOrder){if(o.currentPage<o.pages-1)methods._selectPage.call(this,o.currentPage+1)}else if(o.currentPage>0)methods._selectPage.call(this,o.currentPage-1);return this},getPagesCount:function(){return this.data('pagination').pages},setPagesCount:function(count){this.data('pagination').pages=count},getCurrentPage:function(){return this.data('pagination').currentPage+1},destroy:function(){this.empty();return this},drawPage:function(page){var o=this.data('pagination');o.currentPage=page-1;this.data('pagination',o);methods._draw.call(this);return this},redraw:function(){methods._draw.call(this);return this},disable:function(){var o=this.data('pagination');o.disabled=!0;this.data('pagination',o);methods._draw.call(this);return this},enable:function(){var o=this.data('pagination');o.disabled=!1;this.data('pagination',o);methods._draw.call(this);return this},updateItems:function(newItems){var o=this.data('pagination');o.items=newItems;o.pages=methods._getPages(o);this.data('pagination',o);methods._draw.call(this)},updateItemsOnPage:function(itemsOnPage){var o=this.data('pagination');o.itemsOnPage=itemsOnPage;o.pages=methods._getPages(o);this.data('pagination',o);methods._selectPage.call(this,0);return this},getItemsOnPage:function(){return this.data('pagination').itemsOnPage},_draw:function(){var o=this.data('pagination'),interval=methods._getInterval(o),i,tagName;methods.destroy.call(this);var $panel='UL'===(tagName='function'===typeof this.prop?this.prop('tagName'):this.attr('tagName'))?this:$('<ul'+(o.listStyle?' class="'+o.listStyle+'"':'')+'></ul>').appendTo(this);if(o.prevText)methods._appendItem.call(this,!o.invertPageOrder?o.currentPage-1:o.currentPage+1,{text:o.prevText,classes:'prev'});if(o.nextText&&o.nextAtFront)methods._appendItem.call(this,!o.invertPageOrder?o.currentPage+1:o.currentPage-1,{text:o.nextText,classes:'next'});if(!o.invertPageOrder){if(interval.start>0&&o.edges>0){if(o.useStartEdge){var end=Math.min(o.edges,interval.start);for(i=0;i<end;i++)methods._appendItem.call(this,i)}if(o.edges<interval.start&&interval.start-o.edges!=1)$panel.append('<li class="disabled"><span class="ellipse">'+o.ellipseText+'</span></li>');else if(interval.start-o.edges==1)methods._appendItem.call(this,o.edges)}}else if(interval.end<o.pages&&o.edges>0){if(o.useStartEdge){var begin=Math.max(o.pages-o.edges,interval.end);for(i=o.pages-1;i>=begin;i--)methods._appendItem.call(this,i)}if(o.pages-o.edges>interval.end&&o.pages-o.edges-interval.end!=1)$panel.append('<li class="disabled"><span class="ellipse">'+o.ellipseText+'</span></li>');else if(o.pages-o.edges-interval.end==1)methods._appendItem.call(this,interval.end)}if(!o.invertPageOrder)for(i=interval.start;i<interval.end;i++)methods._appendItem.call(this,i);else for(i=interval.end-1;i>=interval.start;i--)methods._appendItem.call(this,i);if(!o.invertPageOrder){if(interval.end<o.pages&&o.edges>0){if(o.pages-o.edges>interval.end&&o.pages-o.edges-interval.end!=1)$panel.append('<li class="disabled"><span class="ellipse">'+o.ellipseText+'</span></li>');else if(o.pages-o.edges-interval.end==1)methods._appendItem.call(this,interval.end);if(o.useEndEdge){var begin;for(i=begin=Math.max(o.pages-o.edges,interval.end);i<o.pages;i++)methods._appendItem.call(this,i)}}}else if(interval.start>0&&o.edges>0){if(o.edges<interval.start&&interval.start-o.edges!=1)$panel.append('<li class="disabled"><span class="ellipse">'+o.ellipseText+'</span></li>');else if(interval.start-o.edges==1)methods._appendItem.call(this,o.edges);if(o.useEndEdge){var end;for(i=(end=Math.min(o.edges,interval.start))-1;i>=0;i--)methods._appendItem.call(this,i)}}if(o.nextText&&!o.nextAtFront)methods._appendItem.call(this,!o.invertPageOrder?o.currentPage+1:o.currentPage-1,{text:o.nextText,classes:'next'});if(o.ellipsePageSet&&!o.disabled)methods._ellipseClick.call(this,$panel)},_getPages:function(o){var pages;return Math.ceil(o.items/o.itemsOnPage)||1},_getInterval:function(o){return{start:Math.ceil(o.currentPage>o.halfDisplayed?Math.max(Math.min(o.currentPage-o.halfDisplayed,o.pages-o.displayedPages),0):0),end:Math.ceil(o.currentPage>o.halfDisplayed?Math.min(o.currentPage+o.halfDisplayed,o.pages):Math.min(o.displayedPages,o.pages))}},_appendItem:function(pageIndex,opts){var self=this,options,$link,o=self.data('pagination'),$linkWrapper=$('<li></li>'),$ul=self.find('ul');options={text:(pageIndex=pageIndex<0?0:pageIndex<o.pages?pageIndex:o.pages-1)+1,classes:''};if(o.labelMap.length&&o.labelMap[pageIndex])options.text=o.labelMap[pageIndex];options=$.extend(options,opts||{});if(pageIndex==o.currentPage||o.disabled){if(o.disabled||'prev'===options.classes||'next'===options.classes)$linkWrapper.addClass('disabled');else $linkWrapper.addClass('active');$link=$('<span class="current">'+options.text+'</span>')}else{if(o.useAnchors)$link=$('<a href="'+o.hrefTextPrefix+(pageIndex+1)+o.hrefTextSuffix+'" class="page-link">'+options.text+'</a>');else $link=$('<span >'+options.text+'</span>');$link.click(function(event){return methods._selectPage.call(self,pageIndex,event)})}if(options.classes)$link.addClass(options.classes);$linkWrapper.append($link);if($ul.length)$ul.append($linkWrapper);else self.append($linkWrapper)},_selectPage:function(pageIndex,event){var o=this.data('pagination');o.currentPage=pageIndex;if(o.selectOnClick)methods._draw.call(this);return o.onPageClick(pageIndex+1,event)},_ellipseClick:function($panel){var self=this,o=this.data('pagination'),$ellip=$panel.find('.ellipse');$ellip.addClass('clickable').parent().removeClass('disabled');$ellip.click(function(event){if(!o.disable){var $this=$(this),val=(parseInt($this.parent().prev().text(),10)||0)+1;$this.html('<input type="number" min="1" max="'+o.pages+'" step="1" value="'+val+'">').find('input').focus().click(function(event){event.stopPropagation()}).keyup(function(event){var val=$(this).val();if(13===event.which&&''!==val){if(val>0&&val<=o.pages)methods._selectPage.call(self,val-1)}else if(27===event.which)$ellip.empty().html(o.ellipseText)}).bind('blur',function(event){var val=$(this).val();if(''!==val)methods._selectPage.call(self,val-1);$ellip.empty().html(o.ellipseText);return!1})}return!1})}},void($.fn.pagination=function(method){if(methods[method]&&'_'!=method.charAt(0))return methods[method].apply(this,Array.prototype.slice.call(arguments,1));else if('object'===typeof method||!method)return methods.init.apply(this,arguments);else $.error('Method '+method+' does not exist on jQuery.pagination')});var $,methods},{}]},{},[4]);